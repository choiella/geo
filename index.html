<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>노원구 공릉동 카페 지도</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <style>
        html, body { height: 100%; margin: 0; }
        #map { height: 100%; width: 100%; }
        .map-title {
            position: absolute; z-index: 1000; left: 12px; top: 12px;
            background: rgba(255,255,255,0.9); backdrop-filter: saturate(1.2) blur(2px);
            border-radius: 12px; padding: 10px 12px; box-shadow: 0 2px 10px rgba(0,0,0,.08);
            font-size: 14px; line-height: 1.2; color: #111; font-weight: 600;
        }
        .leaflet-popup-content b { font-size: 14px; }
        .leaflet-popup-content small { color:#555; }
        @media (prefers-color-scheme: dark) {
            .map-title { background: rgba(32,32,32,0.85); color: #e8e8e8; }
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="map-title">노원구 공릉동 카페 지도</div>
    
    <script>
    const DATA = {
        "stores": [
            // 공릉동 주요 카페 데이터 (직접 지오코딩하여 업데이트)
            {"name":"기차가 있는 풍경","address":"서울 노원구 화랑로 446","lat":37.620078,"lng":127.086435, "category": "기타"},
            {"name":"블루샥 공릉점","address":"서울 노원구 공릉로 219","lat":37.631248,"lng":127.074712, "category": "기타"},
            {"name":"던모스 공릉","address":"서울 노원구 동일로190길 63-14","lat":37.625892,"lng":127.076846, "category": "기타"},
            {"name":"파운드 그레도 공릉","address":"서울 노원구 공릉로 231","lat":37.632007,"lng":127.075482, "category": "대형"},
            {"name":"리프노즈 드 아쉬지 공릉","address":"서울 노원구 공릉로 136-1","lat":37.627341,"lng":127.071880, "category": "디저트"},
            {"name":"스타벅스 태릉입구역DT점","address":"서울 노원구 동일로 1060","lat":37.618037,"lng":127.073400, "category": "기타"},
            {"name":"컴포즈커피 공릉경춘선숲길점","address":"서울 노원구 공릉로 219","lat":37.631248,"lng":127.074712, "category": "기타"},
            {"name":"무드쉐어","address":"서울 노원구 공릉로 119-23","lat":37.626880,"lng":127.071060, "category": "디저트"},
            {"name":"블루마일스","address":"서울 노원구 동일로190길 65","lat":37.625902,"lng":127.076882, "category": "로스터리"},
            {"name":"마이브라더스","address":"서울 노원구 공릉로 211","lat":37.630656,"lng":127.074312, "category": "베이커리"},
            {"name":"공트럴파크 카페","address":"서울 노원구 공릉동 675","lat":37.6262,"lng":127.0768, "category": "기타"},
            {"name":"호이폴로이커피로스터스","address":"서울 노원구 동일로192길 44","lat":37.626359,"lng":127.077227, "category": "로스터리"},
            {"name":"트위그 페스츄리","address":"서울 노원구 동일로190길 63-14","lat":37.625892,"lng":127.076846, "category": "베이커리"},
            {"name":"플랫커피 공릉","address":"서울 노원구 동일로 192길 63-15","lat":37.625573,"lng":127.076882, "category": "기타"},
            {"name":"금성다방 공릉","address":"서울 노원구 공릉로39길 10","lat":37.618608,"lng":127.076936, "category": "기타"}
        ]
    };

    const map = L.map('map', {
        center: [37.6262, 127.0768],
        zoom: 15,
        scrollWheelZoom: true
    });

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
    subdomains: 'abcd'
}).addTo(map);

    const markers = L.markerClusterGroup({ showCoverageOnHover: false, spiderfyOnMaxZoom: true });
    
    function addAllMarkers() {
        markers.clearLayers(); 
        const bounds = [];
        DATA.stores.forEach(store => {
            if (!Number.isFinite(store.lat) || !Number.isFinite(store.lng)) return;

            const popupHtml = `<div><b>${store.name}</b><br/><small>${store.address || ''}</small></div>`;
            const m = L.marker([store.lat, store.lng]).bindPopup(popupHtml);
            
            const tooltipText = `${store.name}<br/>${store.address}`;
            m.bindTooltip(tooltipText, { permanent: false, direction: 'top' });

            markers.addLayer(m);
            bounds.push([store.lat, store.lng]);
        });
        
        map.addLayer(markers);
        if (bounds.length) map.fitBounds(bounds, { padding: [24, 24] });
    }

    addAllMarkers();
    </script>
</body>
</html>